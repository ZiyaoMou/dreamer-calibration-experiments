/var/spool/slurmd/job229220/slurm_script: line 11: module: command not found
/var/spool/slurmd/job229220/slurm_script: line 14: /home/zmou1/anaconda3/etc/profile.d/conda.sh: No such file or directory

CondaError: Run 'conda init' before 'conda activate'

/usr/bin/which: no nvcc in (/home/zmou1/scratchenalisn1/ziyao/anaconda3/envs/dreamerv2-cal/bin:/opt/mprov/bin:/weka/home/zmou1/.vscode-server/cli/servers/Stable-e54c774e0add60467559eb0d1e229c6452cf8447/server/bin/remote-cli:/home/zmou1/scratchenalisn1/ziyao/anaconda3/condabin:/home/zmou1/.local/bin:/home/zmou1/bin:/opt/mprov/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/sbin:/opt/mprov/software/jobstats/jobstats:/opt/mprov/software:/opt/mprov/software/jobstats/jobstats:/opt/mprov/software)
2025-04-17 17:11:00.953466: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:00.953495: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Linked libcusolver.so.10 → ./lib64/libcusolver.so.11
Linked libcudart.so.11.0 → ./lib64/libcudart.so.11.0
Thu Apr 17 17:11:02 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:E4:00.0 Off |                    0 |
| N/A   31C    P8             33W /  350W |       1MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
2025-04-17 17:11:02.975412: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:02.975436: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-17 17:11:04.478365: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2025-04-17 17:11:04.480296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2025-04-17 17:11:04.547493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:e4:00.0 name: NVIDIA L40S computeCapability: 8.9
coreClock: 2.52GHz coreCount: 142 deviceMemorySize: 44.42GiB deviceMemoryBandwidth: 804.75GiB/s
2025-04-17 17:11:04.549418: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.550855: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcublas.so.11'; dlerror: libcublas.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.552293: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcublasLt.so.11'; dlerror: libcublasLt.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.553680: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.555389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2025-04-17 17:11:04.557170: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.558676: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcusparse.so.11'; dlerror: libcusparse.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.560327: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: ./lib64:
2025-04-17 17:11:04.560334: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1757] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
TF sees GPUs: []

Config:
logdir:                     /home/zmou1/logdir/atari_pong/dreamerv2/1  (str)
seed:                       0                                          (int)
task:                       atari_pong                                 (str)
envs:                       1                                          (int)
envs_parallel:              none                                       (str)
render_size:                [64, 64]                                   (ints)
dmc_camera:                 -1                                         (int)
atari_grayscale:            True                                       (bool)
time_limit:                 27000                                      (int)
action_repeat:              4                                          (int)
steps:                      50000000.0                                 (float)
log_every:                  10000.0                                    (float)
eval_every:                 250000.0                                   (float)
eval_eps:                   1                                          (int)
prefill:                    50000                                      (int)
pretrain:                   1                                          (int)
train_every:                16                                         (int)
train_steps:                1                                          (int)
expl_until:                 0                                          (int)
replay.capacity:            2000000.0                                  (float)
replay.ongoing:             False                                      (bool)
replay.minlen:              50                                         (int)
replay.maxlen:              50                                         (int)
replay.prioritize_ends:     True                                       (bool)
dataset.batch:              16                                         (int)
dataset.length:             50                                         (int)
log_keys_video:             [image]                                    (strs)
log_keys_sum:               ^$                                         (str)
log_keys_mean:              ^$                                         (str)
log_keys_max:               ^$                                         (str)
precision:                  16                                         (int)
jit:                        True                                       (bool)
clip_rewards:               tanh                                       (str)
expl_behavior:              greedy                                     (str)
expl_noise:                 0.0                                        (float)
eval_noise:                 0.0                                        (float)
eval_state_mean:            False                                      (bool)
grad_heads:                 [decoder, reward, discount]                (strs)
pred_discount:              True                                       (bool)
rssm.ensemble:              1                                          (int)
rssm.hidden:                600                                        (int)
rssm.deter:                 600                                        (int)
rssm.stoch:                 32                                         (int)
rssm.discrete:              32                                         (int)
rssm.act:                   elu                                        (str)
rssm.norm:                  none                                       (str)
rssm.std_act:               sigmoid2                                   (str)
rssm.min_std:               0.1                                        (float)
encoder.mlp_keys:           $^                                         (str)
encoder.cnn_keys:           image                                      (str)
encoder.act:                elu                                        (str)
encoder.norm:               none                                       (str)
encoder.cnn_depth:          48                                         (int)
encoder.cnn_kernels:        [4, 4, 4, 4]                               (ints)
encoder.mlp_layers:         [400, 400, 400, 400]                       (ints)
decoder.mlp_keys:           $^                                         (str)
decoder.cnn_keys:           image                                      (str)
decoder.act:                elu                                        (str)
decoder.norm:               none                                       (str)
decoder.cnn_depth:          48                                         (int)
decoder.cnn_kernels:        [5, 5, 6, 6]                               (ints)
decoder.mlp_layers:         [400, 400, 400, 400]                       (ints)
reward_head.layers:         4                                          (int)
reward_head.units:          400                                        (int)
reward_head.act:            elu                                        (str)
reward_head.norm:           none                                       (str)
reward_head.dist:           mse                                        (str)
discount_head.layers:       4                                          (int)
discount_head.units:        400                                        (int)
discount_head.act:          elu                                        (str)
discount_head.norm:         none                                       (str)
discount_head.dist:         binary                                     (str)
loss_scales.kl:             0.1                                        (float)
loss_scales.reward:         1.0                                        (float)
loss_scales.discount:       5.0                                        (float)
loss_scales.proprio:        1.0                                        (float)
kl.free:                    0.0                                        (float)
kl.forward:                 False                                      (bool)
kl.balance:                 0.8                                        (float)
kl.free_avg:                True                                       (bool)
model_opt.opt:              adam                                       (str)
model_opt.lr:               0.0002                                     (float)
model_opt.eps:              1e-05                                      (float)
model_opt.clip:             100                                        (int)
model_opt.wd:               1e-06                                      (float)
actor.layers:               4                                          (int)
actor.units:                400                                        (int)
actor.act:                  elu                                        (str)
actor.norm:                 none                                       (str)
actor.dist:                 auto                                       (str)
actor.min_std:              0.1                                        (float)
critic.layers:              4                                          (int)
critic.units:               400                                        (int)
critic.act:                 elu                                        (str)
critic.norm:                none                                       (str)
critic.dist:                mse                                        (str)
actor_opt.opt:              adam                                       (str)
actor_opt.lr:               4e-05                                      (float)
actor_opt.eps:              1e-05                                      (float)
actor_opt.clip:             100                                        (int)
actor_opt.wd:               1e-06                                      (float)
critic_opt.opt:             adam                                       (str)
critic_opt.lr:              0.0001                                     (float)
critic_opt.eps:             1e-05                                      (float)
critic_opt.clip:            100                                        (int)
critic_opt.wd:              1e-06                                      (float)
discount:                   0.999                                      (float)
discount_lambda:            0.95                                       (float)
imag_horizon:               15                                         (int)
actor_grad:                 auto                                       (str)
actor_grad_mix:             0.1                                        (float)
actor_ent:                  0.001                                      (float)
slow_target:                True                                       (bool)
slow_target_update:         100                                        (int)
slow_target_fraction:       1                                          (int)
slow_baseline:              True                                       (bool)
reward_norm.momentum:       1.0                                        (float)
reward_norm.scale:          1.0                                        (float)
reward_norm.eps:            1e-08                                      (float)
expl_intr_scale:            1.0                                        (float)
expl_extr_scale:            0.0                                        (float)
expl_opt.opt:               adam                                       (str)
expl_opt.lr:                0.0003                                     (float)
expl_opt.eps:               1e-05                                      (float)
expl_opt.clip:              100                                        (int)
expl_opt.wd:                1e-06                                      (float)
expl_head.layers:           4                                          (int)
expl_head.units:            400                                        (int)
expl_head.act:              elu                                        (str)
expl_head.norm:             none                                       (str)
expl_head.dist:             mse                                        (str)
expl_reward_norm.momentum:  1.0                                        (float)
expl_reward_norm.scale:     1.0                                        (float)
expl_reward_norm.eps:       1e-08                                      (float)
disag_target:               stoch                                      (str)
disag_log:                  False                                      (bool)
disag_models:               10                                         (int)
disag_offset:               1                                          (int)
disag_action_cond:          True                                       (bool)
expl_model_loss:            kl                                         (str) 

Logdir /home/zmou1/logdir/atari_pong/dreamerv2/1
Traceback (most recent call last):
  File "dreamerv2/train.py", line 196, in <module>
    main()
  File "dreamerv2/train.py", line 49, in main
    assert tf.config.experimental.list_physical_devices('GPU'), message
AssertionError: No GPU found. To actually train on CPU remove this assert.
